use std::cmp;

// const INPUT : &str = "\
// ...#......
// .......#..
// #.........
// ..........
// ......#...
// .#........
// .........#
// ..........
// .......#..
// #...#.....";

const INPUT : &str = "\
............#..................#..........................................................#..........................#......................
.................................................................#...............#..............#...............#......................#....
...................................#.....................#..................#............................#...................#..............
#.....................#.....................#...............................................................................................
........................................................................................#............#......................................
.....#..............................................#.......................................................................................
.......................................#................................#..........#...........#......................................#.....
..................#...........#.............................................................................................................
.............................................#............#.................................................................................
.#............................................................................#..................................#..........................
............#......................#....................................................................#...................#.............#.
.......#............#....................#........#...................................#......................#..............................
...................................................................#................................#.......................................
..............................#.................................................................................................#...........
..#...........................................................................................#.......................#.....................
..............................................................................#.............................................................
.......................................#.........#............#...........................#................#..............................#.
........................................................#.............#.....................................................................
.....#..........................#....................................................................#....................#.................
....................#.......................#...................................#...............#...............#......................#....
...............#..................................................................................................................#.........
..#......................................................................#...................................................#..............
.................................................#............#.........................................#.............#.....................
....................................#.......................................................................................................
...........#..........................................................................#.....................................................
.................#..........................................................................................................................
.............................................#............................#....................................................#............
.........................#.......#..........................#...............................................................................
.......#............#....................................................................................................#..........#.......
...................................................................#................#...........................#...........................
..............#....................................#..........................#..............#..............................................
..#....................#....................................................................................#........#......................
.........................................................................#......................................................#...........
......................................#.........#...........................................................................................
..........#.................................................................................................................................
.....................#......................#...............#.................................................#.............................
...............................#...................................................#....................................#.................#.
.............................................................................................#..............................................
...................................................................#........................................................................
................#..........#.....................#..................................................................................#.......
...................................#............................................#..................#........................................
.....#.....................................................................#...............................#.....#..........................
............#.........................................................................................................#.....................
.....................#.............................#.......................................................................#................
..............................................................#...............................#..........................................#..
.....................................#.......#.................................................................#............................
...............#...................................................................#.....#..............................#...................
...#.....................#.........................................#......#...........................#.....................................
.........#......................................................................................#.............................#.............
..........................................................#.................................................................................
..................................#.......#...........................................#......................#......................#.......
.............................................................................#..............................................................
.....#...........................................#..................................................#....................#..................
............................................................................................................................................
............................................................................................................................................
.................#...................#........................#......#..................................#...................................
..........................#.........................#.....................................#......#.........................#................
..............................................#...........................#.....................................#...........................
#.....................#.................#............................................................................................#......
...............................#..........................#.....................................................................#...........
..........#.........................#.............................#...........#....................................#........................
.....................................................#......................................................................................
.............................................................................................#..............................................
............................................................................................................................................
...............#...........#..........#.....#..................#.......................#......................#.......#..............#......
........#...........#.............................#.....#...................................................................................
............................................................................................................................................
.#................................#.............................................#................................................#..........
............................................................................................................................................
..........................................................................#...............................................................#.
..............................#...............#......................................#........#.............#.........#.....................
...#................................................#.......................................................................................
............................................................................................................................................
.......................#...............#...........................................................#..........................#.............
.................................................#...........#......................................................#.......................
...........#............................................................................#...................................................
.....#..................................................#.....................................#.............#..............................#
..................#..........#..............................................#..........................#..............................#.....
....................................................#.......................................................................................
..#............................................................................................................#................#...........
.............................................................#........#..........#.....#....................................................
...........#..........#............#.......#...............................................................................#................
............................................................................................................................................
......................................................#..............................................#......................................
.........................#.....#...............................................#................................#................#..........
...#.......................................................................................................#...........................#....
........#...........................#....................................#...............#..................................................
..........................................#.......................#.........................................................................
............................................................#.............................................................#.................
...........................#...................................................................#.....................#......................
...............#.................#............#.............................................................................................
...#......#..........................................#..................................#...............#...................................
.................................................................#......................................................................#...
.......................#..................#...............#..................#..............................................................
.................................................#...................................#.............#............................#...........
................#...........................................................................................................................
...................................#.........................................................#........................#.............#.......
.............................................................#..........................#......................#............#..............#
...#..................#.............................#..........................#............................................................
........#......................................#............................................................................................
..............#............#...........#............................................................#.......................................
....................................................................#.......................#...............................................
.#....................................................................................#........................................#.......#....
...........#...................#............................................................................................................
.........................#..........#.......#.........#..................#..................................#...............................
................................................................#....................................................#......................
...#.............................................................................................#.....#....................................
.................................................#....................#.....................................................................
.......................#.........#..................................................#.......#...................#........#..................
........................................................................................................................................#...
...........#................................................#..............................................#................................
.....................................#..........................................................#...........................................
....#.......................................#....................................................................................#..........
...................#..............................................#.........#..........#.............#......................................
............................................................................................................................................
............................................................................................................................................
.............#.......................................#...............#......................#......................#...............#........
...............................................#............................................................................................
....#.................................#.......................................................................................#.............
............................#.................................................#......#.....................................................#
...................#..............#.......#...............#.....................................................#.........#.................
..................................................................#.....................................#...................................
...................................................#..............................#......#.......#..............................#...........
.......................................#.....................#..............#......................................#........................
.................#..........................................................................................................................
..............................................#.......#.................#.................................#.................................
.........#...............#.............................................................#.................................#.............#....
..#..............................#..................................#.......................................................................
...............................................................#...........#.......................................................#........
............................................................................................................................#...............
................#...........#............#.........#........................................................................................
........#.............#........................................................................................#...........................#
..........................................................#...............................#..............#...........................#......
...............................#................................................................#...........................................
..................#.............................................#.........#..........................................#......................
.....#................................................#.........................................................................#...........
............................................#.....................................#.........#...............................................
.......................................................................................................................................#....
#..........#.............#......#.................................#...................................#.....................................
.....................................#.........#.........................#.....#............................................................";


const EMPTY_SPACE_SIZE:i64=1000000-1;

fn main() {
    let lines: Vec<&str> = INPUT.lines().collect();
    
    let SIZE_X = lines[0].len();
    let SIZE_Y = lines.len();
    
    let mut empty_rows:Vec<usize> = Vec::new();
    let mut empty_cols:Vec<usize> = Vec::new();
    // v.push(5);

    // find the empty rows
    for j in 0..SIZE_Y {
        let mut is_empty = true;
        for i in 0..SIZE_X {
          if lines[j].chars().nth(i).unwrap() == '#' {
              is_empty = false;
              break;
          }
        }
        if is_empty{
            empty_rows.push(j);
            println!("row {} is empty", j);
        }
    }
    // find the empty cols
    for i in 0..SIZE_X {
        let mut is_empty = true;
        for j in 0..SIZE_Y {
          if lines[j].chars().nth(i).unwrap() == '#' {
              is_empty = false;
              break;
          }
        }
        if is_empty{
            empty_cols.push(i);
            println!("col {} is empty", i);
        }
    }
    
    // find the galaxies
    let mut galaxies:Vec<(usize,usize)> = Vec::new();
    for j in 0..SIZE_Y {
        for i in 0..SIZE_X {
            if lines[j].chars().nth(i).unwrap() == '#' {
                galaxies.push((j,i))
            }
        }
    }
    
    // find dist between each galaxy
    let mut SUM:i64 = 0;
    
    for src_i in 0..galaxies.len() {
        for dest_i in (src_i+1)..galaxies.len() {
            let src = galaxies[src_i];
            let dest = galaxies[dest_i];

            let mut empty_rows_or_cols_spanned:i64 = 0;
            for row in cmp::min(src.0, dest.0)..cmp::max(src.0, dest.0){
                if empty_rows.contains(&row) {
                    empty_rows_or_cols_spanned+=EMPTY_SPACE_SIZE;
                }
            }
            for col in cmp::min(src.1, dest.1)..cmp::max(src.1, dest.1){
                if empty_cols.contains(&col) {
                    empty_rows_or_cols_spanned+=EMPTY_SPACE_SIZE;
                }
            }
            
            let dist:i64 = ((dest.0 as i64)-(src.0 as i64)).abs() + ((dest.1 as i64) - (src.1 as i64)).abs() + empty_rows_or_cols_spanned;
            SUM+=dist;
            
            // println!("Between galaxy {} and galaxy {}: {} (spans {} empty rows/cols)", src_i+1, dest_i+1, dist, empty_rows_or_cols_spanned);
        }
    }
    println!("SUM IS {}",SUM)
}

